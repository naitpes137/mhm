import{$a as f,$f as q,Cb as T,Db as A,Dg as Q,Ia as x,Ja as w,Mb as R,Md as j,Oa as D,Pa as s,Qa as a,Qd as u,Ra as g,Tf as k,W as p,Wf as L,X as h,Ya as y,_a as _,cg as F,db as b,eb as M,fb as P,g as C,hb as E,kb as r,lb as S,qa as c,qb as I,rb as O,sb as V,ua as d,xa as m}from"./chunk-4LPE7HNY.js";var N=["videoElement"];function B(n,i){if(n&1){let l=y();s(0,"div",3)(1,"div",5),r(2,"Active video source"),a(),s(3,"ss-select",6),V("ngModelChange",function(e){p(l);let o=f();return O(o.selectedDeviceId,e)||(o.selectedDeviceId=e),h(e)}),_("selectionChange",function(){p(l);let e=f();return h(e.onDeviceChange())}),a()()}if(n&2){let l=f();c(3),I("ngModel",l.selectedDeviceId),D("options",l.availableVideoDevices)("disabled",l.availableVideoDevices.length===0)}}var K=(()=>{let i=class i{get transformValue(){let t=null;if(this.videoElement?.nativeElement?.videoHeight){let e=this.videoElement.nativeElement.videoWidth/this.videoElement.nativeElement.videoHeight;t=16/9/e}return t===null||t===1?"":`scale(${t})`}constructor(t,e,o){this.route=t,this.mediaDevicesService=e,this.changeDetectorRef=o,this.availableVideoDevices=[],this.mediaDevicesLoaded=!1,this.mediaDevicesPromptDisplayed=!1,this.stream=null,this.setAvailableDevices=this.setAvailableDevices.bind(this)}ngOnInit(){return C(this,null,function*(){if(this.selectedDeviceId=this.route.snapshot.queryParamMap.get("deviceId")??void 0,!navigator.userAgent.toLowerCase().includes("firefox")&&(yield navigator.permissions.query({name:"camera"})).state==="denied"){this.mediaDevicesLoaded=!0;return}navigator.mediaDevices.addEventListener("devicechange",this.setAvailableDevices),yield this.mediaDevicesService.getDevices("videoinput",!1),this.mediaDevicesPromptDisplayed=!0,yield this.startPreview(this.selectedDeviceId),yield this.setAvailableDevices(),this.mediaDevicesLoaded=!0})}ngOnDestroy(){this.stopStream(),navigator.mediaDevices.removeEventListener("devicechange",this.setAvailableDevices)}onDeviceChange(){this.selectedDeviceId&&this.startPreview(this.selectedDeviceId)}onClose(){window.close()}setAvailableDevices(){return this.mediaDevicesService.getDevices("videoinput",!0).then(t=>{this.availableVideoDevices=t,!this.selectedDeviceId&&this.availableVideoDevices.length&&(this.selectedDeviceId=this.availableVideoDevices[0].deviceId)})}startPreview(t){return C(this,null,function*(){this.stopStream(),this.stream=yield navigator.mediaDevices.getUserMedia({video:t?{deviceId:{exact:t}}:!0}),this.videoElement.nativeElement.srcObject=this.stream,this.videoElement.nativeElement.onloadedmetadata=()=>this.changeDetectorRef.detectChanges(),this.selectedDeviceId||(this.selectedDeviceId=this.stream.getVideoTracks()[0]?.getSettings().deviceId)})}stopStream(){this.stream?.getTracks().forEach(t=>t.stop()),this.stream=null}};i.\u0275fac=function(e){return new(e||i)(d(u),d(k),d(R))},i.\u0275cmp=m({type:i,selectors:[["ss-camera-test"]],viewQuery:function(e,o){if(e&1&&b(N,7),e&2){let v;M(v=P())&&(o.videoElement=v.first)}},standalone:!1,decls:5,vars:4,consts:[["videoElement",""],[1,"video-container"],["autoplay","","muted","","playsinline",""],[1,"select-wrapper"],["role","button","iconName","dismiss","color","default",1,"close-button",3,"click","size"],[1,"title"],["labelProperty","label","valueProperty","deviceId","id","cameraDevice","name","cameraDevice","placeholder","Video device",3,"ngModelChange","selectionChange","ngModel","options","disabled"]],template:function(e,o){if(e&1){let v=y();s(0,"div",1),g(1,"video",2,0),a(),x(3,B,4,3,"div",3),s(4,"ss-icon",4),_("click",function(){return p(v),h(o.onClose())}),a()}e&2&&(c(),E("transform",o.transformValue),c(2),w(o.availableVideoDevices.length>1?3:-1),c(),D("size",24))},dependencies:[L,Q,q,F],styles:["[_nghost-%COMP%]{display:block;width:600px}.video-container[_ngcontent-%COMP%]{width:600px;height:338px;overflow:hidden}.title[_ngcontent-%COMP%]{margin-bottom:5px}video[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.close-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px}.select-wrapper[_ngcontent-%COMP%]{padding:0 16px}"]});let n=i;return n})();var ee=(()=>{let i=class i{constructor(t){this.activatedRoute=t,this.activatedRoute.queryParams.subscribe(e=>{e.errorCode&&(this.errorCode=e.errorCode)})}};i.\u0275fac=function(e){return new(e||i)(d(u))},i.\u0275cmp=m({type:i,selectors:[["ss-spotify-connect-error"]],standalone:!1,decls:7,vars:3,template:function(e,o){e&1&&(s(0,"h1"),r(1,"Spotify error"),a(),s(2,"p"),r(3),T(4,"translate"),a(),s(5,"h4"),r(6,"You can now close this tab"),a()),e&2&&(c(3),S(A(4,1,"errors."+o.errorCode)))},dependencies:[j],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:var(--vh);text-align:center}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:20px;font-weight:500}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px;color:var(--negative-20);font-size:20px;line-height:32px}"]});let n=i;return n})();var ie=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=m({type:i,selectors:[["ss-spotify-connect-success"]],standalone:!1,decls:7,vars:0,consts:[["src","/assets/images/enabling-spotify.gif","alt","spotify toggle",1,"small"]],template:function(e,o){e&1&&(s(0,"h1"),r(1,"Spotify successfully connected!"),a(),s(2,"p"),r(3,"Toggle the switch below to show what you're playing on Spotify in your video tile:"),a(),g(4,"img",0),s(5,"h4"),r(6,"You can now close this tab"),a())},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:var(--vh);text-align:center}[_nghost-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--positive-d2)}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{margin-bottom:20px}"]});let n=i;return n})();export{K as a,ee as b,ie as c};
