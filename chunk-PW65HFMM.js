import{b as ne}from"./chunk-GXZQKE6V.js";import{$a as h,$f as ee,Bd as U,Cb as N,Cd as H,Da as B,Di as se,Eb as j,Ed as J,Fd as K,Ff as X,Gd as I,Hd as T,Ia as v,Ja as C,Kf as Y,Ma as E,Mg as oe,Na as b,Oa as u,Pa as i,Qa as o,Ra as R,W as g,Wf as O,X as x,Ya as y,Yb as G,_a as _,cg as te,db as z,eb as L,fb as $,gg as ie,gh as re,ib as Q,kb as s,lb as f,ma as w,mb as M,nb as F,qa as r,qb as W,rb as Z,sb as q,ua as c,vi as ae,xa as S,xh as D,yh as P,zh as k,zi as A}from"./chunk-4LPE7HNY.js";var de=(()=>{let n=class n{constructor(a){this.dialogRef=a,this.reportComment=""}saveChanges(){this.dialogRef.close(this.reportComment)}};n.\u0275fac=function(d){return new(d||n)(c(U))},n.\u0275cmp=S({type:n,selectors:[["ss-comment-report-modal"]],standalone:!1,decls:10,vars:5,consts:[[1,"mat-header"],["mat-dialog-title","",1,"modal-title"],["mat-dialog-close","",1,"close-modal"],["iconName","dismiss","color","default-20",3,"size","iconVariant"],["id","report-comment","name","reportComment",3,"ngModelChange","ngModel","maxlength"],[1,"divider"],[3,"buttonClick","disabled"]],template:function(d,t){d&1&&(i(0,"div",0)(1,"h1",1),s(2,"Report Comment"),o(),i(3,"button",2),R(4,"ss-icon",3),o()(),i(5,"mat-dialog-content")(6,"ss-textarea",4),q("ngModelChange",function(m){return Z(t.reportComment,m)||(t.reportComment=m),m}),o(),R(7,"div",5),i(8,"ss-button",6),_("buttonClick",function(){return t.saveChanges()}),s(9," Resolve Report "),o()()),d&2&&(r(4),u("size",20)("iconVariant",20),r(2),W("ngModel",t.reportComment),u("maxlength",250),r(2),u("disabled",!t.reportComment.length))},dependencies:[oe,O,ae,ee,ie,te,K,I,T],encapsulation:2});let e=n;return e})();var pe=(e,n)=>n.id;function Re(e,n){if(e&1&&(i(0,"div",2)(1,"div",3),s(2,"Room Name"),o(),i(3,"div"),s(4),o()()),e&2){let l=h();r(4),f(l.userReport.roomName||l.userReport.meetingTopic)}}function _e(e,n){if(e&1&&(i(0,"div",2)(1,"div",3),s(2,"Report Source"),o(),i(3,"div"),s(4),o()()),e&2){let l=h();r(4),f(l.userReport.reportSource)}}function fe(e,n){if(e&1&&(i(0,"div",2)(1,"div",3),s(2,"Channel"),o(),i(3,"div"),s(4),o()()),e&2){let l=h();r(4),f(l.userReport.channelName)}}function ge(e,n){if(e&1&&R(0,"img",8),e&2){let l=h().$implicit;u("src",l.thumbUrl,w)}}function xe(e,n){if(e&1&&(i(0,"div",7),v(1,ge,1,1,"img",8),i(2,"a",9),s(3),o()()),e&2){let l=n.$implicit;r(),C(l.thumbUrl?1:-1),r(),u("href",l.url,w),r(),f(l.originalFileName)}}function Se(e,n){if(e&1&&(i(0,"h2"),s(1,"Attachments"),o(),i(2,"div",6),E(3,xe,4,3,"div",7,pe),o()),e&2){let l=h();r(3),b(l.userReport.attachments)}}function Me(e,n){if(e&1&&R(0,"img",8),e&2){let l=h().$implicit;u("src",l.thumbUrl,w)}}function Ee(e,n){if(e&1){let l=y();i(0,"div",11),_("click",function(){let d=g(l).$implicit,t=h(2);return x(t.downloadChatAttachment(d))}),v(1,Me,1,1,"img",8),s(2),o()}if(e&2){let l=n.$implicit;r(),C(l.thumbUrl?1:-1),r(),M(" ",l.originalFileName," ")}}function be(e,n){if(e&1&&(R(0,"mat-divider"),i(1,"h3"),s(2,"Recent chat attachments"),o(),i(3,"div",6),E(4,Ee,3,2,"div",10,pe),o()),e&2){let l=h();r(4),b(l.recentChatAttachments)}}function ye(e,n){if(e&1&&(i(0,"div",2)(1,"div",3),s(2,"Resolve comment"),o(),i(3,"div"),s(4),N(5,"date"),o()()),e&2){let l=h();r(4),F("",l.userReport.resolveComment," - ",j(5,2,l.userReport.dateResolved,"dd/MM/yyyy hh:mm a"))}}var me=(()=>{let n=class n{constructor(a,d,t,p){this.reportService=a,this.chatService=d,this.toastService=t,this.utilityService=p,this.updateReport=new B,this.recentChatAttachments=[],this.ButtonColorRef=P}ngOnInit(){this.reportService.getRecentChatAttachments(this.userReport.id).subscribe({next:a=>this.recentChatAttachments=a??[],error:a=>this.handleErrors(a)})}updateUserReport(){this.updateReport.emit({id:this.userReport.id,resolve:!this.userReport.resolved})}downloadChatAttachment(a){this.chatService.getBlobDownloadUrl(a.id).subscribe({next:d=>this.utilityService.downloadFile(d.url)})}handleErrors(a){this.toastService.error({exceptionDetail:a[0]})}};n.\u0275fac=function(d){return new(d||n)(c(A),c(se),c(k),c(X))},n.\u0275cmp=S({type:n,selectors:[["ss-user-report"]],inputs:{userReport:"userReport"},outputs:{updateReport:"updateReport"},standalone:!1,decls:40,vars:17,consts:[[1,"header"],[1,"body"],[1,"field-wrapper"],[1,"label"],[1,"button-wrapper"],[3,"click","color"],[1,"attachments"],[1,"attachment"],[1,"attachment-preview",3,"src"],["target","_blank",3,"href"],["role","button",1,"attachment"],["role","button",1,"attachment",3,"click"]],template:function(d,t){d&1&&(i(0,"div",0)(1,"h4"),s(2,"Report Name"),o(),i(3,"div"),s(4),N(5,"date"),o()(),i(6,"div",1),v(7,Re,5,1,"div",2),i(8,"h2"),s(9,"Report Details"),o(),i(10,"div",2)(11,"div",3),s(12,"Report Reason"),o(),i(13,"div"),s(14),o()(),v(15,_e,5,1,"div",2),v(16,fe,5,1,"div",2),i(17,"div",2)(18,"div",3),s(19,"Report Text"),o(),i(20,"div"),s(21),o()(),v(22,Se,5,0),v(23,be,6,0),i(24,"h2"),s(25,"Reporter Information"),o(),i(26,"div",2)(27,"div",3),s(28,"Reporter Full Name"),o(),i(29,"div"),s(30),o()(),i(31,"div",2)(32,"div",3),s(33,"Reporter Email"),o(),i(34,"div"),s(35),o()(),v(36,ye,6,5,"div",2),i(37,"div",4)(38,"ss-button-small",5),_("click",function(){return t.updateUserReport()}),s(39),o()()()),d&2&&(r(4),F("",t.userReport.reportedUserFullName," - ",j(5,14,t.userReport.dateCreated,"dd/MM/yyyy hh:mm a")),r(3),C(t.userReport.roomName||t.userReport.meetingTopic?7:-1),r(7),f(t.userReport.reportReason),r(),C(t.userReport.reportSource?15:-1),r(),C(t.userReport.channelId?16:-1),r(5),f(t.userReport.reportText),r(),C(t.userReport.attachments.length>0?22:-1),r(),C(t.recentChatAttachments.length>0?23:-1),r(7),f(t.userReport.reporterFullName||t.userReport.reporterZoomUserName),r(5),f(t.userReport.reporterEmail||t.userReport.reporterZoomUserEmail),r(),C(t.userReport.resolved?36:-1),r(2),u("color",t.ButtonColorRef.Secondary),r(),M(" ",t.userReport.resolved?"Unarchive":"Archive"," "))},dependencies:[D,ne,G],styles:["[_nghost-%COMP%]{display:block;overflow:auto;margin-bottom:20px;border:1px solid var(--default-80);border-radius:16px}[_nghost-%COMP%]:last-child{margin-bottom:0}.header[_ngcontent-%COMP%]{padding:16px;background:var(--default-80)}.body[_ngcontent-%COMP%]{padding:16px}h2[_ngcontent-%COMP%], .field-wrapper[_ngcontent-%COMP%]{margin-bottom:16px}.label[_ngcontent-%COMP%]{margin-bottom:4px;text-transform:uppercase}.button-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:100%}.attachments[_ngcontent-%COMP%]{margin-bottom:10px}.attachments[_ngcontent-%COMP%]   .attachment[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:10px;gap:4px}.attachments[_ngcontent-%COMP%]   .attachment-preview[_ngcontent-%COMP%]{width:40px}"]});let e=n;return e})();var Ue=["olderReportsLoader"],Ie=(e,n)=>n.id;function Te(e,n){if(e&1&&(i(0,"span"),s(1),o()),e&2){let l=h();r(),M("(",l.totalEntries,")")}}function Oe(e,n){if(e&1){let l=y();i(0,"ss-user-report",11),_("updateReport",function(d){g(l);let t=h();return x(t.updateReport(d))}),o()}if(e&2){let l=n.$implicit;u("userReport",l)}}function De(e,n){e&1&&(i(0,"div",10),s(1,"There are no unresolved reports."),o())}var Ke=(()=>{let n=class n{constructor(a,d,t,p,m){this.userId=a,this.dialogRef=d,this.userReportService=t,this.toastService=p,this.dialog=m,this.showResolved=!1,this.loadedAllReports=!1,this.userReports=[],this.ButtonColorRef=P,this.intersectionObserver=new IntersectionObserver(V=>{V[0].isIntersecting===!0&&this.getUsersReports()},{threshold:[0]})}ngAfterViewInit(){this.intersectionObserver.observe(this.olderReportsLoader.nativeElement)}ngOnDestroy(){Y(this.intersectionObserver,this.olderReportsLoader?.nativeElement)}toggleUserReports(){this.loadedAllReports=!1,this.showResolved=!this.showResolved,this.userReports.length=0}close(){this.dialogRef.close(!0)}getUsersReports(){this.loadedAllReports||(this.model={pageSize:50,oldestReportDateCreated:this.userReports.length?this.userReports[this.userReports.length-1].dateCreated:"",includeResolved:this.showResolved},this.userReportService.getUsersReports(this.model,this.userId).subscribe({next:a=>{this.userReports.push(...a.entries),this.loadedAllReports=this.userReports.length===a.totalEntries,this.totalEntries=a.totalEntries},error:a=>{this.handleErrors(a)}}))}updateReport(a){if(this.showResolved){this.updateResolveStatus(a);return}this.dialog.open(de,{width:"600px"}).afterClosed().subscribe(d=>{d&&this.updateResolveStatus(a,d)})}updateResolveStatus(a,d){let t={resolved:a.resolve,resolveComment:d};this.userReportService.updateResolveStatus(a.id,t).subscribe({next:p=>{let m=this.userReports.find(V=>V.id===p.id);m&&(this.showResolved?(m.resolved=p.resolved,m.resolveComment=p.resolveComment,m.dateResolved=p.dateResolved):(this.userReports.splice(this.userReports.indexOf(m),1),this.totalEntries--))},error:p=>this.handleErrors(p)})}handleErrors(a){this.toastService.error({exceptionDetail:a[0]})}};n.\u0275fac=function(d){return new(d||n)(c(H),c(U),c(A),c(k),c(J))},n.\u0275cmp=S({type:n,selectors:[["ss-user-reports-modal"]],viewQuery:function(d,t){if(d&1&&z(Ue,5),d&2){let p;L(p=$())&&(t.olderReportsLoader=p.first)}},standalone:!1,decls:16,vars:8,consts:[["olderReportsLoader",""],[1,"mat-header"],[1,"heading-wrapper"],["mat-dialog-title","",1,"modal-title"],[3,"click","color"],[1,"close-modal",3,"click"],["iconName","dismiss","color","default-20",3,"size","iconVariant"],[3,"userReport"],[1,"loader-wrapper"],["diameter","20","strokeWidth","2"],[1,"no-reports-message"],[3,"updateReport","userReport"]],template:function(d,t){if(d&1){let p=y();i(0,"div",1)(1,"div",2)(2,"h1",3),s(3,"User Reports "),v(4,Te,2,1,"span"),o(),i(5,"ss-button-small",4),_("click",function(){return g(p),x(t.toggleUserReports())}),s(6),o()(),i(7,"button",5),_("click",function(){return g(p),x(t.close())}),R(8,"ss-icon",6),o()(),i(9,"mat-dialog-content"),E(10,Oe,1,1,"ss-user-report",7,Ie),i(12,"div",8,0),R(14,"mat-spinner",9),o(),v(15,De,2,0,"div",10),o()}d&2&&(r(4),C(t.totalEntries?4:-1),r(),u("color",t.ButtonColorRef.Secondary),r(),M(" ",t.showResolved?"View Unresolved":"View All"," "),r(2),u("size",20)("iconVariant",20),r(2),b(t.userReports),r(2),Q("hide",t.loadedAllReports),r(3),C(!t.showResolved&&t.userReports.length===0&&t.loadedAllReports?15:-1))},dependencies:[O,D,I,T,re,me],styles:[".heading-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}.heading-wrapper[_ngcontent-%COMP%]   ss-button-small[_ngcontent-%COMP%]{margin-left:16px}.loader-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.loader-wrapper.hide[_ngcontent-%COMP%]{display:none}.no-reports-message[_ngcontent-%COMP%]{text-align:center}"]});let e=n;return e})();export{Ke as a};
